## 问题描述

题目希望我们得到一个较为完善的烟雾弹投放策略。其中应当考虑以下要点：1. 最大遮蔽时长， 2.满足约束， 3. 较高的经济效益（在第五问中提及）于是我们可以分解成以下几个要点来剖析问题。

### 题目约束

1. 导弹飞行方向：导弹飞行速度为300m/s，且方向直指圆心。意味着不用考虑导弹的重力加速度，导弹有自适应速度系统，可以一直进行匀速直线运动。
2. 无人机飞行轨迹：无人机以70~140m/s速度等高飞行，且一旦确定下航线和方向就不再改变，因此无人机也作匀速直线运动。
3. 烟幕弹飞行轨迹：烟幕弹在投放后未引爆前，将速度分解成水平和垂直方向，在水平上和无人机同样保持匀速直线运动，在垂直方向上以g = 9.8m/s²的加速度进行匀加速直线运动。合成后为平抛轨迹。烟幕弹引爆后，以3m/s的速度匀速下沉，即整体呈球形作下降的匀速运动。
4. 连续投放烟幕弹时间间隔：由题意可知，每架无人机投放两枚烟幕干扰弹至少间隔1s。
5. 有效遮蔽：以导弹为视线中心，视线内不能出现真目标。

### 经济收益

在第五问中，由于







## 第五问

#### 模型建立与分析：

第五问可以视为前四个小问的集成，既要实现多架无人机的飞行策略，又要实现烟幕弹的投弹策略。延续上面几问的思路，我们可以构建更加高维度的非线性优化问题来进行求解。但是由于该问题参数量过大、求解时间慢并且突围至最优解较为困难，我们使用了多层求解架构来逐层分解问题，做到从疏到密的求解。

另外因为需要确定优化目标，所以这道题应当着重考虑各个导弹的遮蔽情况。我们认为目前有以下两种主要目标：其一是考虑所有导弹都被同时遮蔽住的时间，其二是考虑各个导弹被遮蔽的时间之和。前者在直觉上更符合真目标完全被遮蔽的理解，后者更能表达出各个烟幕弹的作用。经讨论后我们决定选择后者，原因是使用后者作为优化目标可以体现烟幕弹投放策略的多样性。次要目标有烟幕弹投放的经济效益。意味着投放越少烟幕弹、遮蔽越久导弹的情况经济效益会更高。

最终我们建立了多层求解架构的模型，其优化目标为导弹被遮蔽时间之和以及经济效益的加权和。

##### 决策变量

我们定义决策变量A为烟幕弹对遮蔽的导弹的选择集合，即某一烟幕弹选择对某一导弹进行有方向性的遮蔽。定义决策变量X作为无人机飞行参数和烟幕弹投放、引爆参数的集合。共计15+40个参数。



##### 状态方程

同理

##### 目标函数





### **1. 问题定义**

该模型旨在求解一个混合优化问题，其目标是最大化一个黑箱目标函数 $F(\mathbf{A}, \mathbf{X})$。

- **离散决策向量 $\mathbf{A}$**: $\mathbf{A} = (a_1, a_2, ..., a_{15})$，其中 $a_i \in {1, 2, 3}$。 该向量代表一个任务分配方案，将15个单元分配给3个目标。
- **连续参数向量 $\mathbf{X}$**: $\mathbf{X} = (x_1, x_2, ..., x_{40})$，其中 $x_j \in [L_j, U_j] \subset \mathbb{R}$。 该向量代表一个物理系统的40个连续控制参数，每个参数 $x_j$ 都在其下界 $L_j$ 和上界 $U_j$ 内。
- **目标函数 $F(\mathbf{A}, \mathbf{X})$**: 这是一个从 $\mathbb{Z}^{15} \times \mathbb{R}^{40}$ 到 $\mathbb{R}$ 的映射，其值代表在特定分配方案 $\mathbf{A}$ 和参数 $\mathbf{X}$ 下的系统效能（总遮蔽时长）。该函数没有解析表达式，其值只能通过一个外部的数值模拟器（C库）获得。

**优化目标**: 寻找最优解 $(\mathbf{A}^*, \mathbf{X}^*)$，使得： $(\mathbf{A}^*, \mathbf{X}^*) = \arg\max_{\mathbf{A}, \mathbf{X}} F(\mathbf{A}, \mathbf{X})$

### **2. 求解策略：双层分解**

该问题被分解为一个双层结构：

- **上层问题 (组合优化)**: 寻找最优的离散分配向量 $\mathbf{A}^*$。 $\mathbf{A}^* = \arg\max_{\mathbf{A}} G(\mathbf{A})$
- **下层问题 (连续优化)**: 对于一个给定的上层分配向量 $\mathbf{A}$，寻找最优的连续参数向量 $\mathbf{X}^*(\mathbf{A})$。 $G(\mathbf{A}) = \max_{\mathbf{X}} F(\mathbf{A}, \mathbf{X})$

其中，$G(\mathbf{A})$ 是上层问题的目标函数，其每一次求值都需要求解一次下层问题。

### **2. 求解策略：双层优化**

问题被分解为上下两层：

- **上层 (遗传算法, GA)**: 在离散空间中搜索最优的分配向量 $\mathbf{A}^*$。 $\mathbf{A}^* = \arg\max_{\mathbf{A}} G(\mathbf{A})$
- **下层 (L-SHADE算法)**: 对于给定的 $\mathbf{A}$，在连续空间中求解其最优参数，从而计算其适应度 $G(\mathbf{A})$。 $G(\mathbf{A}) = \max_{\mathbf{X}} F(\mathbf{A}, \mathbf{X})$

### **3. 核心求解流程**

1. **初始化**:
   - 加载一个持久化缓存 $\mathcal{C}$，该缓存存储已知的映射关系 $\mathbf{A} \mapsto \mathbf{X}$。
   - 定义一个先验解（种子） $(\mathbf{A}*{seed}, \mathbf{X}*{seed})$。
2. **种子预优化**:
   - 对种子解的参数进行一次下层优化，得到一个更优的参数集 $\mathbf{X}'_{seed}$。
   - $\mathbf{X}'*{seed} = \text{L-SHADE}(F, \mathbf{A}*{seed}, \mathbf{X}_{seed})$
3. **上层遗传算法 (GA) 迭代**:
   - **a. 适应度评估**: 对GA种群中的每一个体 $\mathbf{A}_i$，执行以下操作来计算其适应度 $G(\mathbf{A}_i)$:
     1. 从缓存 $\mathcal{C}$ 中查找 $\mathbf{A}*i$ 对应的参数 $\mathbf{X}*{cache}$ 作为下层优化的起点。
     2. 通过迭代调用下层求解器 $\text{L-SHADE}$ 来优化参数，得到 $\mathbf{X}^*_i$。
     3. 更新并保存缓存：$\mathcal{C}(\mathbf{A}_i) \leftarrow \mathbf{X}^*_i$。
     4. $G(\mathbf{A}_i) = F(\mathbf{A}_i, \mathbf{X}^*_i)$。
   - **b. 进化**: 应用选择、交叉、变异算子生成下一代种群。
   - **c. 精英保留**: 持续追踪并保留迄今为止最优的 $k$ 个解 $(\mathbf{A}, \mathbf{X})$，记为集合 $\mathcal{S}_{top}$。
4. **精细化求解**:
   - 对 $\mathcal{S}_{top}$ 中的每一个解 $(\mathbf{A}_j, \mathbf{X}_j)$，以 $\mathbf{X}_j$ 为起点，再次执行一次高预算的下层优化，得到最终参数 $\mathbf{X}'_j$。
5. **最终解**:
   - 比较所有精细化后的解，适应度最高者即为最终报告的全局最优解 $(\mathbf{A}^*, \mathbf{X}^*)$。



##### 求解结果



