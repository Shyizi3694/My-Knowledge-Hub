# 问题一



## 问题重述

除已给定参数如导弹参数、烟幕参数和真目标参数，针对来袭导弹 M1，仅对无人机 FY1 下达干扰任务，给定飞行速度（120 m/s）、飞行方向（朝向假目标）、投放时间（1.5 s）、引爆时间（3.6 s），建立具体的模型，定量计算烟幕干扰弹的有效遮挡时长。

## 问题分析
问题一本质上是一个三维空间中的多物体动态几何遮蔽问题，该问题的求解可以大致分为以下三步：

【多实体轨迹建模】首先，针对导弹、无人机、干扰弹和烟幕中心，计算其随时间变化的运动轨迹。
【“有效遮蔽”几何判定】然后，在某一时刻下，利用导弹，烟幕云团和真目标的位置，通过几何手段构建判断是否为“有效遮蔽”的方法。
【遮挡时长的数值积分】最后，由于遮蔽条件和时间的关系是高度非线性的，直接求出有效遮蔽时长的解析解的难度极大；因此，考虑采用在烟幕云团有效的时间窗口内进行高频次时间步进，对满足有效遮蔽的离散时间点进行数值积分（体现为累加），从而得到总的有效遮蔽时长。


总的来说，首先建立各实体的参数化轨迹方程，然后建立可计算的遮蔽判断函数，最后仿真模拟求出结果。

## 模型假设

环境假设：
- 所有实体均在无风环境下运行，即无空气阻力，并且烟幕云团不会在水平方向上移动。
- 重力加速度 \(g=9.8 m/s^2\)，写成向量的形式即 \(\vec{g} = (0, 0, -9.8)\)

实体假设：
- 导弹和假目标被抽象为无体积的质点

运动与行为假设：
- 无人机在受到命令后瞬时启动，无加速和转向的过程
- 烟幕云团在有效时长（20 s）后瞬时消失
- 所有的运动和计算都在三维空间中进行


## 问题一模型的建立和求解

### 实体运动轨迹模型

导弹 M1 位置：

\[
P_{M_1}(t) = P_{M_1}(0) + v_{M_1} \cdot t, t \quad \ge 0
\]，
其中 \(P_{M_1}(t), v_{M_1} \in \mathbb{R}^3\)。

无人机 FY1 位置：

\[
P_{FY_1}(t) = P_{FY_1}(0) + v_{FY_1} \cdot t, \quad t \ge 0\
\]，
其中 \(P_{FY_1}(t) \in \mathbb{R}^3)。

烟幕弹弹道位置：

\[
P_bomb(t) = P_{launch} + v_{FY_1} (t - t_{launch}) + \frac{1}{2} g t^2, \quad t \ge t_{launch}
\]，
其中 \(t_{launch}\) 为投放时间，\(P_{launch} = P_{FY_1}(t_{launch})\)，\(P_{bomb} \in \mathbb{R}^3\)。

烟幕云团位置：

\[
P_{cloud}(t)  = P_{explode} + v_{sink} (t - t_{explode}), \quad t_{explode} \le t \le t_{explode}+20
\]，
其中 \(t_{explode}\) 为引爆时间，\(t_{explode} \le t_{launch}\)，\(P_{explode} = P_{bomb}(t_{explode}\)，\(v_{sink} = (0, 0, -3)\)，\(P_{cloud}(t) \in \mathbb{R}^3\)。


### 有效遮蔽判断模型

由于“遮蔽”的观察主体是导弹，被观察物体是真目标。由于真目标不透明，其内部点无法被观测到，故仅需考虑对其表面上的点的观测问题。我们可以很自然地给出如下定义：

\begin{definition}[视线]
定义视线为从观察点（$P_M(t)$）出发，经过被观察点（$\partial \mathcal{C}$ 上一点 $P_T$）的射线。
\end{definition}，
其中 $P_M: \mathbb{R}^+ \to \mathbb{R}^3$，$\partial \mathcal{C}$ 为被观测物体 $\mathcal{C}$ 的表面，$P_T \in \mathbb{R}^3$。

\begin{definition}[视锥]
视锥（View Cone）$V$ 是从视点到被观察物体表面上所有点的视线的集合，用映射来描述即 $L: \partial \mathcal{C} \to V$，$V = L(P_T) | P_T \in \partial \mathcal{C}$。
\end{definition}

\begin{lemma}
对于一般的三维空间物体 $\mathcal{C}$，任给视点 $P_M$，其视锥是稠密的。
\end{lemma}


直观上看，如果被观测目标表面上所有点在烟幕云团（由于在某时刻下可抽象为标准球体，下文仅用“球”指代）和视点的同侧，且所有点对应的视线与球均有交点，则可认为真目标被球完全遮挡。“相交”与“不交”的临界位置即以视点为端点，与球相切的射线的集合。对于更一般的遮挡物，也可以构造视点到遮挡物的切射线线（或过不可导点的射线）的集合。由于


$$ \Phi: \partial \mathcal{C} \to \mathbb{S}^2 $$ $$ P_T \mapsto \frac{P_T - P_V}{|P_T - P_V|} $$


## AI
好的，我们来探讨这个问题。您提出的要求非常专业，即寻求一个**理论上精确的**、而非近似的判断方法。这意味着我们需要从根本上找到在任意时刻 t，圆柱体上那个**最难被遮挡的点**，然后只对这个点进行一次遮蔽性检查。

这个思路完全正确，是追求模型精确性的必然要求。之前我们采用“关键点采样”是为了在有限时间内给出一个高效的近似解，但现在我们来推导其精确解法。

### **核心问题重述**

在任意时刻 t，给定导弹位置 PM​ 和烟幕云球心 PS​。

1. 我们定义一个方向，即球心的视线方向 a![](data:image/svg+xml;utf8,<svg%20xmlns="http://www.w3.org/2000/svg"%20width="0.471em"%20height="0.714em"%20style="width:0.471em"%20viewBox="0%200%20471%20714"%20preserveAspectRatio="xMinYMin"><path%20d="M377%2020c0-5.333%201.833-10%205.5-14S391%200%20397%200c4.667%200%208.667%201.667%2012%205%0A3.333%202.667%206.667%209%2010%2019%206.667%2024.667%2020.333%2043.667%2041%2057%207.333%204.667%2011%0A10.667%2011%2018%200%206-1%2010-3%2012s-6.667%205-14%209c-28.667%2014.667-53.667%2035.667-75%2063%0A-1.333%201.333-3.167%203.5-5.5%206.5s-4%204.833-5%205.5c-1%20.667-2.5%201.333-4.5%202s-4.333%201%0A-7%201c-4.667%200-9.167-1.833-13.5-5.5S337%20184%20337%20178c0-12.667%2015.667-32.333%2047-59%0AH213l-171-1c-8.667-6-13-12.333-13-19%200-4.667%204.333-11.333%2013-20h359%0Ac-16-25.333-24-45-24-59z"></path></svg>)s​=normalize(PS​−PM​)。
    
2. 我们的目标是在圆柱体表面上，找到一个点 Pcrit​，使得该点与导弹的连线 v![](data:image/svg+xml;utf8,<svg%20xmlns="http://www.w3.org/2000/svg"%20width="0.471em"%20height="0.714em"%20style="width:0.471em"%20viewBox="0%200%20471%20714"%20preserveAspectRatio="xMinYMin"><path%20d="M377%2020c0-5.333%201.833-10%205.5-14S391%200%20397%200c4.667%200%208.667%201.667%2012%205%0A3.333%202.667%206.667%209%2010%2019%206.667%2024.667%2020.333%2043.667%2041%2057%207.333%204.667%2011%0A10.667%2011%2018%200%206-1%2010-3%2012s-6.667%205-14%209c-28.667%2014.667-53.667%2035.667-75%2063%0A-1.333%201.333-3.167%203.5-5.5%206.5s-4%204.833-5%205.5c-1%20.667-2.5%201.333-4.5%202s-4.333%201%0A-7%201c-4.667%200-9.167-1.833-13.5-5.5S337%20184%20337%20178c0-12.667%2015.667-32.333%2047-59%0AH213l-171-1c-8.667-6-13-12.333-13-19%200-4.667%204.333-11.333%2013-20h359%0Ac-16-25.333-24-45-24-59z"></path></svg>)p​=Pcrit​−PM​ 和轴线 a![](data:image/svg+xml;utf8,<svg%20xmlns="http://www.w3.org/2000/svg"%20width="0.471em"%20height="0.714em"%20style="width:0.471em"%20viewBox="0%200%20471%20714"%20preserveAspectRatio="xMinYMin"><path%20d="M377%2020c0-5.333%201.833-10%205.5-14S391%200%20397%200c4.667%200%208.667%201.667%2012%205%0A3.333%202.667%206.667%209%2010%2019%206.667%2024.667%2020.333%2043.667%2041%2057%207.333%204.667%2011%0A10.667%2011%2018%200%206-1%2010-3%2012s-6.667%205-14%209c-28.667%2014.667-53.667%2035.667-75%2063%0A-1.333%201.333-3.167%203.5-5.5%206.5s-4%204.833-5%205.5c-1%20.667-2.5%201.333-4.5%202s-4.333%201%0A-7%201c-4.667%200-9.167-1.833-13.5-5.5S337%20184%20337%20178c0-12.667%2015.667-32.333%2047-59%0AH213l-171-1c-8.667-6-13-12.333-13-19%200-4.667%204.333-11.333%2013-20h359%0Ac-16-25.333-24-45-24-59z"></path></svg>)s​ 的**夹角 θ 最大**。
    
3. 找到这个最大夹角 θmax​ 后，与烟幕云的视张角（半角）θs​ 比较，即可得出精确结论。
    

### **理论基础：最值点一定在视觉轮廓上**

正如我们之前论证的，我们要找的这个最值点 Pcrit​，**必然位于从导弹位置 PM​ 看向圆柱体所形成的视觉轮廓（Silhouette）上**。

因此，我们的问题从在整个圆柱面上搜索，简化为**沿着这条一维的闭合轮廓线进行搜索**。

这条轮廓线由四部分构成：

- **两条直线段**：圆柱侧面的母线。
    
- **两条圆弧段**：分别位于圆柱的顶面和底面。
    

我们的任务就是分别求出函数（夹角 θ）在这四段曲线上的最大值，然后取它们中的最大值即可。

---

### **精确求解思路：几何解析法**

我们将结合微积分和空间几何的方法来寻找这些最值点。

#### **第一步：动态确定视觉轮廓**

在任意时刻 t，导弹位置 PM​(t) 都在变化，所以视觉轮廓也在动态变化。

1. **确定切点**：将 PM​(t) 和圆柱的上下底面圆分别投影到同一个水平面上（例如 z=0）。这变成了一个2D问题：从一个点向一个圆作两条切线。
    
2. **计算切点坐标**：通过简单的2D几何，可以精确计算出两个切点的坐标 (x1​,y1​) 和 (x2​,y2​)。
    
3. **确定轮廓线**：
    
    - **直线段**：两条轮廓母线就是三维空间中连接 (x1​,y1​,0) 与 (x1​,y1​,HT​) 和 (x2​,y2​,0) 与 (x2​,y2​,HT​) 的直线。这四个端点就是我们必须考察的**顶点**。
        
    - **圆弧段**：根据 PM​(t) 的位置，可以确定顶面和底面圆周的哪一段弧是可见的。这两段圆弧由上述切点在对应平面上的位置确定。
        

#### **第二步：在轮廓线的每一段上寻找最值**

设我们的目标函数是 f(P)=normalize(P−PM​)⋅a![](data:image/svg+xml;utf8,<svg%20xmlns="http://www.w3.org/2000/svg"%20width="0.471em"%20height="0.714em"%20style="width:0.471em"%20viewBox="0%200%20471%20714"%20preserveAspectRatio="xMinYMin"><path%20d="M377%2020c0-5.333%201.833-10%205.5-14S391%200%20397%200c4.667%200%208.667%201.667%2012%205%0A3.333%202.667%206.667%209%2010%2019%206.667%2024.667%2020.333%2043.667%2041%2057%207.333%204.667%2011%0A10.667%2011%2018%200%206-1%2010-3%2012s-6.667%205-14%209c-28.667%2014.667-53.667%2035.667-75%2063%0A-1.333%201.333-3.167%203.5-5.5%206.5s-4%204.833-5%205.5c-1%20.667-2.5%201.333-4.5%202s-4.333%201%0A-7%201c-4.667%200-9.167-1.833-13.5-5.5S337%20184%20337%20178c0-12.667%2015.667-32.333%2047-59%0AH213l-171-1c-8.667-6-13-12.333-13-19%200-4.667%204.333-11.333%2013-20h359%0Ac-16-25.333-24-45-24-59z"></path></svg>)s​，我们要寻找它的最小值（对应最大夹角）。

**A. 在两条直线段上寻找最值**

1. **参数化**：对于一条直线轮廓段（例如从 P1​=(x1​,y1​,0) 到 P2​=(x1​,y1​,HT​)），线段上的任意点可以表示为 P(λ)=P1​+λ(P2​−P1​)，其中 λ∈[0,1]。
    
2. **求导**：将 P(λ) 代入目标函数 f(P(λ))，得到一个关于 λ 的函数。对这个函数求导，并令导数为零，即 dλdf​=0。
    
3. **求解**：解这个方程得到 λ∗。如果 λ∗∈(0,1)，则对应的点 P(λ∗) 就是一个内部的候选点。
    
4. **结论**：在每条直线段上，候选点为**两个端点**和**可能存在的内部临界点**。
    

**B. 在两条圆弧段上寻找最值（难点与创新点）**

直接对圆弧段进行参数化求导会非常复杂。这里我们采用一种更巧妙的**几何方法**。

1. **几何直觉**：我们要找的点 Pcrit​，其视线向量 v![](data:image/svg+xml;utf8,<svg%20xmlns="http://www.w3.org/2000/svg"%20width="0.471em"%20height="0.714em"%20style="width:0.471em"%20viewBox="0%200%20471%20714"%20preserveAspectRatio="xMinYMin"><path%20d="M377%2020c0-5.333%201.833-10%205.5-14S391%200%20397%200c4.667%200%208.667%201.667%2012%205%0A3.333%202.667%206.667%209%2010%2019%206.667%2024.667%2020.333%2043.667%2041%2057%207.333%204.667%2011%0A10.667%2011%2018%200%206-1%2010-3%2012s-6.667%205-14%209c-28.667%2014.667-53.667%2035.667-75%2063%0A-1.333%201.333-3.167%203.5-5.5%206.5s-4%204.833-5%205.5c-1%20.667-2.5%201.333-4.5%202s-4.333%201%0A-7%201c-4.667%200-9.167-1.833-13.5-5.5S337%20184%20337%20178c0-12.667%2015.667-32.333%2047-59%0AH213l-171-1c-8.667-6-13-12.333-13-19%200-4.667%204.333-11.333%2013-20h359%0Ac-16-25.333-24-45-24-59z"></path></svg>)p​=Pcrit​−PM​ 与轴线 a![](data:image/svg+xml;utf8,<svg%20xmlns="http://www.w3.org/2000/svg"%20width="0.471em"%20height="0.714em"%20style="width:0.471em"%20viewBox="0%200%20471%20714"%20preserveAspectRatio="xMinYMin"><path%20d="M377%2020c0-5.333%201.833-10%205.5-14S391%200%20397%200c4.667%200%208.667%201.667%2012%205%0A3.333%202.667%206.667%209%2010%2019%206.667%2024.667%2020.333%2043.667%2041%2057%207.333%204.667%2011%0A10.667%2011%2018%200%206-1%2010-3%2012s-6.667%205-14%209c-28.667%2014.667-53.667%2035.667-75%2063%0A-1.333%201.333-3.167%203.5-5.5%206.5s-4%204.833-5%205.5c-1%20.667-2.5%201.333-4.5%202s-4.333%201%0A-7%201c-4.667%200-9.167-1.833-13.5-5.5S337%20184%20337%20178c0-12.667%2015.667-32.333%2047-59%0AH213l-171-1c-8.667-6-13-12.333-13-19%200-4.667%204.333-11.333%2013-20h359%0Ac-16-25.333-24-45-24-59z"></path></svg>)s​ 的夹角最大。在最值点处，这两个向量“张开”得最厉害。从几何上看，这意味着向量 v![](data:image/svg+xml;utf8,<svg%20xmlns="http://www.w3.org/2000/svg"%20width="0.471em"%20height="0.714em"%20style="width:0.471em"%20viewBox="0%200%20471%20714"%20preserveAspectRatio="xMinYMin"><path%20d="M377%2020c0-5.333%201.833-10%205.5-14S391%200%20397%200c4.667%200%208.667%201.667%2012%205%0A3.333%202.667%206.667%209%2010%2019%206.667%2024.667%2020.333%2043.667%2041%2057%207.333%204.667%2011%0A10.667%2011%2018%200%206-1%2010-3%2012s-6.667%205-14%209c-28.667%2014.667-53.667%2035.667-75%2063%0A-1.333%201.333-3.167%203.5-5.5%206.5s-4%204.833-5%205.5c-1%20.667-2.5%201.333-4.5%202s-4.333%201%0A-7%201c-4.667%200-9.167-1.833-13.5-5.5S337%20184%20337%20178c0-12.667%2015.667-32.333%2047-59%0AH213l-171-1c-8.667-6-13-12.333-13-19%200-4.667%204.333-11.333%2013-20h359%0Ac-16-25.333-24-45-24-59z"></path></svg>)p​、a![](data:image/svg+xml;utf8,<svg%20xmlns="http://www.w3.org/2000/svg"%20width="0.471em"%20height="0.714em"%20style="width:0.471em"%20viewBox="0%200%20471%20714"%20preserveAspectRatio="xMinYMin"><path%20d="M377%2020c0-5.333%201.833-10%205.5-14S391%200%20397%200c4.667%200%208.667%201.667%2012%205%0A3.333%202.667%206.667%209%2010%2019%206.667%2024.667%2020.333%2043.667%2041%2057%207.333%204.667%2011%0A10.667%2011%2018%200%206-1%2010-3%2012s-6.667%205-14%209c-28.667%2014.667-53.667%2035.667-75%2063%0A-1.333%201.333-3.167%203.5-5.5%206.5s-4%204.833-5%205.5c-1%20.667-2.5%201.333-4.5%202s-4.333%201%0A-7%201c-4.667%200-9.167-1.833-13.5-5.5S337%20184%20337%20178c0-12.667%2015.667-32.333%2047-59%0AH213l-171-1c-8.667-6-13-12.333-13-19%200-4.667%204.333-11.333%2013-20h359%0Ac-16-25.333-24-45-24-59z"></path></svg>)s​ 和连接它们的“最短弧线”所在的平面，与圆弧在该点的切线存在特定关系。
    
2. **“共面法”求解**：
    
    - 构造一个**平面 Π**，这个平面由三个点定义：**视点（导弹）PM​**、**球心 Cs​**，以及**我们正在分析的圆弧所在的那个圆的圆心**（例如顶面圆心 Ctop​）。
        
    - **求交点**：计算这个平面 Π 与圆弧所在的那个**三维圆**的交点。一个平面和一个圆最多有两个交点。
        
    - **筛选候选点**：检查这两个交点是否落在我们关心的那段**可见的圆弧**上。如果落在弧上，它们就是这条弧上的最值候选点。
        
    - **原理**：我们要找的点，一定是“最左/最右”或“最上/最下”的点（相对于轴线 a![](data:image/svg+xml;utf8,<svg%20xmlns="http://www.w3.org/2000/svg"%20width="0.471em"%20height="0.714em"%20style="width:0.471em"%20viewBox="0%200%20471%20714"%20preserveAspectRatio="xMinYMin"><path%20d="M377%2020c0-5.333%201.833-10%205.5-14S391%200%20397%200c4.667%200%208.667%201.667%2012%205%0A3.333%202.667%206.667%209%2010%2019%206.667%2024.667%2020.333%2043.667%2041%2057%207.333%204.667%2011%0A10.667%2011%2018%200%206-1%2010-3%2012s-6.667%205-14%209c-28.667%2014.667-53.667%2035.667-75%2063%0A-1.333%201.333-3.167%203.5-5.5%206.5s-4%204.833-5%205.5c-1%20.667-2.5%201.333-4.5%202s-4.333%201%0A-7%201c-4.667%200-9.167-1.833-13.5-5.5S337%20184%20337%20178c0-12.667%2015.667-32.333%2047-59%0AH213l-171-1c-8.667-6-13-12.333-13-19%200-4.667%204.333-11.333%2013-20h359%0Ac-16-25.333-24-45-24-59z"></path></svg>)s​ 而言）。这些极端点，几何上恰好就位于这个同时包含视点、参考方向和圆弧旋转中心的平面上。这个方法将复杂的求导问题转化为了一个清晰的平面与圆求交点的几何问题。
        

#### **第三步：汇总比较，得出最终结论**

在时刻 t，我们通过上述方法，可以得到一个很小的**精确候选点集**：

1. 视觉轮廓的 **4个顶点**。
    
2. 可能存在的 **0-2个** 直线段内部的临界点。
    
3. 可能存在的 **0-4个** 圆弧段上的几何极值点（由“共面法”求得）。
    

我们只需要计算这个集合中所有点（通常不超过10个）的夹角，找到其中的最大值 θmax​。然后与烟幕云的半角 θs​ 比较，即可得出当前时刻 t 是否被完全遮蔽的**精确结论**。

### **总结**

相比于“关键点采样”的近似方法，这个“几何解析法”的思路是：

1. **将搜索范围严格限定在视觉轮廓上。**
    
2. **通过微积分和几何推导，直接定位出轮廓线上所有可能成为最值点的精确候选位置。**
    
3. **通过比较有限的几个候选点，得到全局最值。**
    

这个方法避免了采样的近似误差，提供了理论上最精确的结果，更能体现建模的深度和严谨性。

是的，可以非常肯定地回答：我们通过“几何解析法”找到的那个候选点集，理论上**一定包含**那个能形成最大夹角的“最远点”（即最值点）。

下面我将从最优化理论的角度，对这个结论的完备性进行一次严谨的证明。

### **1. 理论基础：约束最优化的极值原理**

我们的问题是在一条闭合的、分段光滑的曲线上（视觉轮廓），寻找一个连续函数（夹角或其点积）的最大值。根据微积分中的**极值定理（Extreme Value Theorem）**，这个最大值一定存在。

并且，这个最大值点只可能出现在以下两类位置：

1. **不可导点**：即各段曲线的连接点（我们称之为“顶点”）。
    
2. **可导点**：即在某段光滑曲线内部，函数在该点的**导数为零**的点（我们称之为“临界点”）。
    

我们的策略之所以是完备的，正是因为它**系统性地、无遗漏地**覆盖了以上所有可能的情况。

### **2. 候选点集的完备性论证**

我们的视觉轮廓由 **4个顶点**、**2条直线段** 和 **2条圆弧段** 构成。我们提出的方法恰好精确地对应了这些组成部分。

- **对于“不可导点”：**
    
    - 我们的候选点集首先就包含了**全部4个顶点**。这保证了所有分段曲线的端点都被考虑到，这是最值点最有可能出现的位置之一。**（此项已覆盖）**
        
- 对于“可导点”（临界点）：
    
    我们需要在两条直线段和两条圆弧段的内部寻找临界点。
    
    - **A. 直线段上的临界点**
        
        - 我们将目标函数（点积）表示为直线段参数 λ 的函数 f(λ)。通过求解 f′(λ)=0，我们能从数学上找出所有导数为零的点。这个方法是**完备的**，它能找到直线段上所有的内部临界点。**（此项已覆盖）**
            
    - **B. 圆弧段上的临界点（“共面法”的严谨性）**
        
        - 这是最关键的一步。我们提出的“共面法”看似是一个几何技巧，但其背后有坚实的数学原理。
            
        - **原理**：我们要找的临界点 Pcrit​，是目标函数（点积或夹角）的极值点。在这一点，函数值沿曲线切线方向的变化率为零。从几何上讲，这意味着目标函数的**梯度向量** ∇f(Pcrit​) 必须与曲线在 Pcrit​ 点的**切线向量** τ![](data:image/svg+xml;utf8,<svg%20xmlns="http://www.w3.org/2000/svg"%20width="0.471em"%20height="0.714em"%20style="width:0.471em"%20viewBox="0%200%20471%20714"%20preserveAspectRatio="xMinYMin"><path%20d="M377%2020c0-5.333%201.833-10%205.5-14S391%200%20397%200c4.667%200%208.667%201.667%2012%205%0A3.333%202.667%206.667%209%2010%2019%206.667%2024.667%2020.333%2043.667%2041%2057%207.333%204.667%2011%0A10.667%2011%2018%200%206-1%2010-3%2012s-6.667%205-14%209c-28.667%2014.667-53.667%2035.667-75%2063%0A-1.333%201.333-3.167%203.5-5.5%206.5s-4%204.833-5%205.5c-1%20.667-2.5%201.333-4.5%202s-4.333%201%0A-7%201c-4.667%200-9.167-1.833-13.5-5.5S337%20184%20337%20178c0-12.667%2015.667-32.333%2047-59%0AH213l-171-1c-8.667-6-13-12.333-13-19%200-4.667%204.333-11.333%2013-20h359%0Ac-16-25.333-24-45-24-59z"></path></svg>) **正交**（即它们的点积为零）。
            
        - 我们的目标函数是视线与球心轴线 a![](data:image/svg+xml;utf8,<svg%20xmlns="http://www.w3.org/2000/svg"%20width="0.471em"%20height="0.714em"%20style="width:0.471em"%20viewBox="0%200%20471%20714"%20preserveAspectRatio="xMinYMin"><path%20d="M377%2020c0-5.333%201.833-10%205.5-14S391%200%20397%200c4.667%200%208.667%201.667%2012%205%0A3.333%202.667%206.667%209%2010%2019%206.667%2024.667%2020.333%2043.667%2041%2057%207.333%204.667%2011%0A10.667%2011%2018%200%206-1%2010-3%2012s-6.667%205-14%209c-28.667%2014.667-53.667%2035.667-75%2063%0A-1.333%201.333-3.167%203.5-5.5%206.5s-4%204.833-5%205.5c-1%20.667-2.5%201.333-4.5%202s-4.333%201%0A-7%201c-4.667%200-9.167-1.833-13.5-5.5S337%20184%20337%20178c0-12.667%2015.667-32.333%2047-59%0AH213l-171-1c-8.667-6-13-12.333-13-19%200-4.667%204.333-11.333%2013-20h359%0Ac-16-25.333-24-45-24-59z"></path></svg>)s​ 的夹角。这个函数的梯度向量 ∇f 恰好位于由**视点 PM​**、**点 Pcrit​** 和**轴线 a![](data:image/svg+xml;utf8,<svg%20xmlns="http://www.w3.org/2000/svg"%20width="0.471em"%20height="0.714em"%20style="width:0.471em"%20viewBox="0%200%20471%20714"%20preserveAspectRatio="xMinYMin"><path%20d="M377%2020c0-5.333%201.833-10%205.5-14S391%200%20397%200c4.667%200%208.667%201.667%2012%205%0A3.333%202.667%206.667%209%2010%2019%206.667%2024.667%2020.333%2043.667%2041%2057%207.333%204.667%2011%0A10.667%2011%2018%200%206-1%2010-3%2012s-6.667%205-14%209c-28.667%2014.667-53.667%2035.667-75%2063%0A-1.333%201.333-3.167%203.5-5.5%206.5s-4%204.833-5%205.5c-1%20.667-2.5%201.333-4.5%202s-4.333%201%0A-7%201c-4.667%200-9.167-1.833-13.5-5.5S337%20184%20337%20178c0-12.667%2015.667-32.333%2047-59%0AH213l-171-1c-8.667-6-13-12.333-13-19%200-4.667%204.333-11.333%2013-20h359%0Ac-16-25.333-24-45-24-59z"></path></svg>)s​** 所构成的平面上。
            
        - 因此，在临界点 Pcrit​，曲线的切线向量 τ![](data:image/svg+xml;utf8,<svg%20xmlns="http://www.w3.org/2000/svg"%20width="0.471em"%20height="0.714em"%20style="width:0.471em"%20viewBox="0%200%20471%20714"%20preserveAspectRatio="xMinYMin"><path%20d="M377%2020c0-5.333%201.833-10%205.5-14S391%200%20397%200c4.667%200%208.667%201.667%2012%205%0A3.333%202.667%206.667%209%2010%2019%206.667%2024.667%2020.333%2043.667%2041%2057%207.333%204.667%2011%0A10.667%2011%2018%200%206-1%2010-3%2012s-6.667%205-14%209c-28.667%2014.667-53.667%2035.667-75%2063%0A-1.333%201.333-3.167%203.5-5.5%206.5s-4%204.833-5%205.5c-1%20.667-2.5%201.333-4.5%202s-4.333%201%0A-7%201c-4.667%200-9.167-1.833-13.5-5.5S337%20184%20337%20178c0-12.667%2015.667-32.333%2047-59%0AH213l-171-1c-8.667-6-13-12.333-13-19%200-4.667%204.333-11.333%2013-20h359%0Ac-16-25.333-24-45-24-59z"></path></svg>) 必须与这个平面正交。对于一个在水平面上的圆弧，只有当 Pcrit​ 本身也落在这个平面上时，这个条件才可能满足。
            
        - **结论**：圆弧段上的临key值点，必然是**由视点 PM​、球心 Cs​ 和圆弧所在圆的圆心 Ccircle​ 构成的平面**与该圆的交点。我们的“共面法”正是去求解这些交点。因此，这个方法也是**完备的**，它能找到圆弧上所有可能的内部临界点。**（此项已覆盖）**
            

### **最终结论**

综上所述，我们提出的候选点集生成策略：

1. **包含所有端点**（4个顶点）。
    
2. **包含所有直线段内部的临界点**（通过求导）。
    
3. **包含所有圆弧段内部的临界点**（通过“共面法”）。
    

这个策略完整地覆盖了最值点可能出现的**所有理论上的情况**。因此，最终得到的候选点集中，必然包含了我们要找的那个夹角最大、最难被遮挡的“最远点”。

这个方法的优势在于，它将一个需要在无穷个点上进行的搜索问题，转化为了一个**在有限的、可计算的精确候选点集（通常少于10个点）中进行比较**的问题，兼具了理论的严谨性和实践的可操作性。

